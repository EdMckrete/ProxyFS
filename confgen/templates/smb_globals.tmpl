{{/* Declare our global variables.  Need Go 1.11+ */}}
{{$AdIDCommentStr := ""}}
{{$AdDisabledCommentStr := ""}}
{{ if .AdDisabled }}
	{{$AdIDCommentStr = ";"}}
	{{$AdDisabledCommentStr := ";"}}
{{ end }}

[global]

# ----------------------- Network-Related Options -------------------------
{{ if .WorkGroup }}
	workgroup = {{ .WorkGroup }}
{{ end }}
	server string = Samba Server Version %v
	map to guest = {{ .MapToGuest }}

	netbios name = {{ .HostName }}
	server min protocol = {{ .ServerMinProtocol }}


# --------------------------- Temporary Options -------------------------
# Until we resolve permissions
{{ $AdDisabledCommentStr }}force user = root
	

# --------------------------- Logging Options -----------------------------

	# log files split per-machine:
	log file = /opt/ss/var/log/samba/log.%m
	# maximum size of 50KB per log file, then rotate:
	max log size = 50
{{ if .AuditLogging }}
	log level = full_audit:1
{{ end }}

# ----------------------- Standalone Server Options ------------------------
	security = {{ .Security }}
	{{ .AdDisabled }}passdb backend = tdbsam:/opt/ss/lib64/samba/passdb.tdb
	restrict anonymous = 2
	rpc_server:lsarpc = {{ .RPCServerLSARPC }}


# ----------------------- Domain Members Options ------------------------
{{ $AdDisabledCommentStr }}realm = {{ .Realm }}
{{ $AdIDCommentStr }}winbind nss info = {{ .IDSchema }}
winbind use default domain = yes
winbind refresh tickets = yes
winbind enum users = yes
winbind enum groups = yes
winbind expand groups = 5
winbind nested groups = yes

{{ $AdDisabledCommentStr }}idmap config *:backend = tdb
{{ $AdDisabledCommentStr }}idmap config *:range = {{ .IDRangeMin1 }} - {{ .IDRangeMax1 }}

{{ $AdDisabledCommentStr }}idmap config {{ .WorkGroup }}:backend = {{ .BackEnd }}
{{ $AdDisabledCommentStr }}idmap config {{ .WorkGroup }}:default = yes
{{ $AdDisabledCommentStr }}idmap config {{ .WorkGroup }}:range = {{ .IDRangeMin2 }} - {{ .IDRangeMax2 }}

{{ $AdDisabledCommentStr }}template shell = /sbin/nologin
{{ $AdDisabledCommentStr }}domain master = no
{{ $AdDisabledCommentStr }}preferred master = no
	  	 	  
{{ $AdDisabledCommentStr }}kerberos method = secrets and keytab


#----------------------------- Name Resolution -------------------------------

{{ $AdDisabledCommentStr }}wins server =
{{ $AdDisabledCommentStr }}remote announce = {{ .BrowserAnnounce }}/{{ .WorkGroup }}

# --------------------------- ProxyFS Options ---------------------------

	proxyfs:PrivateIPAddr = {{ .PrivateProxyFSIP }}
	proxyfs:TCPPort = {{ .TCPPort }}
	proxyfs:FastTCPPort = {{ .FastTCPPort }}
