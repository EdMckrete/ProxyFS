{{/* Declare our global variables.  Need Go 1.11+ */}}
{{$AdIDCommentStr := ""}}
{{$ADDisabledCommentStr := ""}}
{{ if .ADDisabled }}
	{{$AdIDCommentStr = ";"}}
	{{$ADDisabledCommentStr := ";"}}
{{ end }}

[global]

# ----------------------- Network-Related Options -------------------------
{{ if .WorkGroup }}
	workgroup = {{ .WorkGroup }}
{{ end }}
	server string = Samba Server Version %v
	map to guest = {{ .MapToGuest }}

	netbios name = {{ .HostName }}
	server min protocol = {{ .ServerMinProtocol }}


# --------------------------- Temporary Options -------------------------
# Until we resolve permissions
{{ $ADDisabledCommentStr }}force user = root
	

# --------------------------- Logging Options -----------------------------

	# log files split per-machine:
	log file = /opt/ss/var/log/samba/log.%m
	# maximum size of 50KB per log file, then rotate:
	max log size = 50
{{ if .AuditLogging }}
	log level = full_audit:1
{{ end }}

# ----------------------- Standalone Server Options ------------------------
	security = {{ .Security }}
	{{ .ADDisabled }}passdb backend = tdbsam:/opt/ss/lib64/samba/passdb.tdb
	restrict anonymous = 2
	rpc_server:lsarpc = {{ .RPCServerLSARPC }}


# ----------------------- Domain Members Options ------------------------
{{ $ADDisabledCommentStr }}realm = {{ .Realm }}
{{ $AdIDCommentStr }}winbind nss info = {{ .IDSchema }}
winbind use default domain = yes
winbind refresh tickets = yes
winbind enum users = yes
winbind enum groups = yes
winbind expand groups = 5
winbind nested groups = yes

{{ $ADDisabledCommentStr }}idmap config *:backend = tdb
{{ $ADDisabledCommentStr }}idmap config *:range = {{ .IDRangeMin1 }} - {{ .IDRangeMax1 }}

{{ $ADDisabledCommentStr }}idmap config {{ .WorkGroup }}:backend = {{ .BackEnd }}
{{ $ADDisabledCommentStr }}idmap config {{ .WorkGroup }}:default = yes
{{ $ADDisabledCommentStr }}idmap config {{ .WorkGroup }}:range = {{ .IDRangeMin2 }} - {{ .IDRangeMax2 }}

{{ $ADDisabledCommentStr }}template shell = /sbin/nologin
{{ $ADDisabledCommentStr }}domain master = no
{{ $ADDisabledCommentStr }}preferred master = no
	  	 	  
{{ $ADDisabledCommentStr }}kerberos method = secrets and keytab


#----------------------------- Name Resolution -------------------------------

{{ $ADDisabledCommentStr }}wins server =
{{ $ADDisabledCommentStr }}remote announce = {{ .BrowserAnnounce }}/{{ .WorkGroup }}

# --------------------------- ProxyFS Options ---------------------------

	proxyfs:PrivateIPAddr = {{ .PrivateProxyFSIP }}
	proxyfs:TCPPort = {{ .TCPPort }}
	proxyfs:FastTCPPort = {{ .FastTCPPort }}
